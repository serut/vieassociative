

<?php $medium_centred = true; ?>
<?php $__env->startSection('medium-content'); ?>
    <section>
        <div>
            <ul class="breadcrumb">
              <li><a href="#">Association</a> </li>
              <li><a href="/<?php echo $association->id; ?>-<?php echo $association->slug; ?>"><?php echo $association->name; ?></a> </li>
              <li><a href="/<?php echo $association->id; ?>/edit">Edition</a> </li>
              <li class="active">Les administrateurs</li>
            </ul>
            <?php if(! $admin->isEmpty()): ?>
            <h3 class="head"><?php echo Lang::get('association/edit/administrator.list_admin'); ?> </h3>
            <hr>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <td><?php echo Lang::get('association/edit/administrator.nickname'); ?></td>
                        <td><?php echo Lang::get('association/edit/administrator.date_function_added'); ?></td>
                        <td><?php echo Lang::get('association/edit/administrator.link'); ?></td>
                        <?php if($is_admin): ?>
                        <td><?php echo Lang::get('association/edit/administrator.remove'); ?></td>
                        <?php endif; ?>
                    </tr>
                </thead>
                <?php foreach($admin as $k=>$v): ?>
                <tbody>
                    <tr>
                        <td><?php echo $v->author->username; ?></td>
                        <td><?php echo \Carbon\Carbon::createFromTimeStamp(strtotime($v->updated_at))->formatLocalized('%A %d %B %Y %H:%I'); ?></td>
                        <td><?php echo $v->link; ?></td>
                        <?php if($is_admin): ?>
                        <td><a href="#" onclick="removeAdmin(<?php echo $v->id; ?>);return false;"><i class="fa fa-times"></i></a></td>
                        <?php endif; ?>
                    </tr>
                </tbody>
                <?php endforeach; ?>
            </table>
            <?php else: ?>
                Cette association n'a pas d'administrateur. Avant de vous d√©clarer administrateur, veuillez prendre connaissance des  
                <a target="_blank" href="/info/condition"><?php echo Lang::get('association/form_create.notice_part_link'); ?></a>.
                <?php echo Lang::get('association/form_create.notice_create_association'); ?>
            <?php endif; ?>
            <?php if($is_admin || !$admin->count()): ?>
            <hr>
            <div>
                <h3 class="head"><?php echo Lang::get('association/edit/administrator.add_admin'); ?> </h3>
                <?php echo Form::open(array('class'=> 'form-horizontal form-modal','data-validate'=>'our-parsey', 'url'=>'/'.$association->id.'/form/administrator/add', 'data-loading'=>'true')); ?>
                    <?php $input= array(
                        'id'=>"who",
                        'name'=> 'who',
                        'data-toggle'=> 'div-user',
                        'elements' => array(
                            '1'=>array(
                                'value'=>'false',
                                'text'=>Lang::get('association/edit/administrator.add_me'),
                                'checked'=>true,
                            ),
                            '2'=>array(
                                'value'=>'true',
                                'text'=>Lang::get('association/edit/administrator.add_someone_else'),
                            ),
                        )
                    ); ?>
                    <?php if($is_admin): ?>
                        <div id="div-user">
                    <?php else: ?>
                        <?php echo SiteHelpers::create_radio($input); ?>
                        <div style="display:none;" id="div-user">
                    <?php endif; ?>
                        <?php $input= array(
                            'id'=>"admin_mail",
                            'label'=>Lang::get('association/edit/administrator.label_admin_mail'),
                            'form' => array(
                                'placeholder'=>Lang::get('association/edit/administrator.placeholder_admin_mail'),
                                'class' => 'form-control',
                                'data-original-title'=>Lang::get('association/edit/administrator.tooltip_admin_mail'),
                                'data-type'=>"email",
                            )
                        ); ?>
                        <?php echo SiteHelpers::create_input($input); ?>
                    </div>

                    <div id="div-linked">
                        <p class="col-sm-push-4 col-sm-8"><?php echo Lang::get('association/edit/administrator.he_is'); ?> : 
                            <a class="btn-vie-assoc" type="button" onclick="$('#link').val($(this).text());"><?php echo Lang::get('association/form_create.link_one'); ?></a>
                            <a class="btn-vie-assoc" type="button" onclick="$('#link').val($(this).text());"><?php echo Lang::get('association/form_create.link_two'); ?></a>
                            <a class="btn-vie-assoc" type="button" onclick="$('#link').val($(this).text());"><?php echo Lang::get('association/form_create.link_three'); ?></a>
                        </p>
                        <?php $input= array(
                            'id'=>"link",
                            'label'=>Lang::get('association/form_create.label_link'),
                            'form' => array(
                                'placeholder'=>Lang::get('association/form_create.placeholder_link'),
                                'class' => 'form-control',
                                'data-original-title'=>Lang::get('association/form_create.tooltip_link'),
                                'data-maxlength'=>"30",
                                'required'=>"required",
                            )
                        ); ?>
                        <?php echo SiteHelpers::create_input($input); ?>
                    </div>
                    <p class="nav pull-right">
                        <button type="submit" class="button button-green"><?php echo Lang::get('association/edit/administrator.add'); ?></button>
                    </p>
                    <br>
                <?php echo Form::close(); ?>
                </div>
            </div>
            <?php endif; ?>
        </div>
    </section>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('footer-js'); ?>
<script type="text/javascript">
    var IDASSOC = <?php echo $association->id; ?>;
    function removeAdmin(id){
        $.ajax({
            type: "POST",
            url: '/'+IDASSOC+'/form/administrator/remove',
            dataType: "json",
            data: {'id':id}
        }).done(function ( data ) {
            window.location = data['redirect_url'];
        }).fail(function() {
            alert("error");
        });
    }
</script>
<?php $__env->stopSection(); ?>

<?php echo $__env->make('template.theme', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>